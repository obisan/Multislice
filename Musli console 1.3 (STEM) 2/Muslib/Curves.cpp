#include "stdafx.h"

double scat_ampl_rec_DT_DW(int i, double s)
{
double sf=0;
int j ;
s*=s ;
 for(j=0;j<4;j++) sf+=bank[i].ab[j][0]*exp(-bank[i].ab[j][1]*s);

return sf;
}
extern "C" _declspec(dllexport)double scat_ampl_rs_DT_DW(int i, double s, double dw) // здесь i - атомный номер элемента
{
double sf=0 ;
s*=-4.0*M_PI*M_PI*s;
int j ;
 for(j=0;j<4;j++) 
	 if(bank[i].ab[j][1]>0) sf+=bank[i].ab[j][0]/(bank[i].ab[j][1]+dw)*exp(s/(bank[i].ab[j][1]+dw));

return sf*4*M_PI;
}

extern "C" _declspec(dllexport)double scat_ampl_rs2_DT_DW(int i, double s, double dw) // здесь i - атомный номер элемента, s - КВАДРАТ расстояния
{
double sf=0 ;
s*=-4.0*M_PI*M_PI;
int j ;
 for(j=0;j<4;j++) 
	 if(bank[i].ab[j][1]>0) sf+=bank[i].ab[j][0]/(bank[i].ab[j][1]+dw)*exp(s/(bank[i].ab[j][1]+dw));

return sf*4*M_PI;
}

extern "C" _declspec(dllexport)double scat_ampl_rs2_DT_DW0(int i, double s) // здесь i - атомный номер элемента, s - КВАДРАТ расстояния
{
double sf=0 ;
s*=-4.0*M_PI*M_PI;
int j ;
 for(j=0;j<4;j++) 
	 if(bank[i].ab[j][1]>0) sf+=bank[i].ab[j][0]/(bank[i].ab[j][1])*exp(s/(bank[i].ab[j][1]));

return sf*4*M_PI;
}

extern "C" _declspec(dllexport) void CreatePots_rec_DT_DW(ULONG Ntypes,ULONG Npoints,double dds,LONG *types,double *DW,double _Vol, double *sc)
{	
	double *centr ;
	double s ;
	double dw ;
	int ty ;
	ULONG i ;
	for(ULONG nt=0;nt<Ntypes;nt++)
	{
		centr=sc+nt*Npoints ;
		ty=*(types+nt) ;
		dw=*(DW+nt) ;
		for(i=0, s=0;i<Npoints;i++,s+=dds)
		{ 
			*(centr+i)=scat_ampl_rec_DT_DW(ty,s)*exp(-dw*s*s)*_Vol ;
		}
	}
}
extern "C" _declspec(dllexport) void CreatePots_rs_DT_DW(ULONG Ntypes,ULONG Npoints,double dds,LONG *types,double *DW,double *sc)
{	
	double *centr ;
	double s ;
	double dw ;
	int ty ;
	ULONG i ;
	for(ULONG nt=0;nt<Ntypes;nt++)
	{
		centr=sc+nt*Npoints ;
		ty=*(types+nt) ;
		dw=*(DW+nt) ;
		    for(i=0, s=0;i<Npoints;i++,s+=dds)
		    { 
			    *(centr+i)=scat_ampl_rs_DT_DW(ty,s,dw) ;
		    }
		
	}
}
// DoyleTurner bank
struct DoyleTurner bank[]=
{
0,"0",0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,
1,"H",0.2022,30.8679,0.2437,8.5444,0.0825,1.2726,0.0000,0.0000,
2,"He",0.0906,18.1834,0.1814,6.2109,0.1095,1.8026,0.0362,0.2844,
3,"Li",1.6108,107.6384,1.2460,30.4795,0.3257,4.5331,0.0986,0.4951,
4,"Be",1.2498,60.8042,1.3335,18.5914,0.3603,3.6534,0.1055,0.4157,
5,"B",0.9446,46.4438,1.3120,14.1778,0.4188,3.2228,0.1159,0.3767,
6,"C",0.7307,36.9951,1.1951,11.2966,0.4563,2.8139,0.1247,0.3456,
7,"N",0.5717,28.8465,1.0425,9.0542,0.4647,2.4213,0.1311,0.3167,
8,"O",0.4548,23.7803,0.9173,7.6220,0.4719,2.1440,0.1384,0.2959,
9,"F",0.3686,20.2390,0.8109,6.6093,0.4751,1.9310,0.1459,0.2793,
10,"Ne",0.3025,17.6396,0.7202,5.8604,0.4751,1.7623,0.1534,0.2656,
11,"Na",2.2406,108.0039,1.3326,24.5047,0.9070,3.3914,0.2863,0.4346,
12,"Mg",2.2682,73.6704,1.8025,20.1749,0.8394,3.0181,0.2892,0.4046,
13,"Al",2.2756,72.3220,2.4280,19.7729,0.8578,3.0799,0.3166,0.4076,
14,"Si",2.1293,57.7748,2.5333,16.4756,0.8349,2.8796,0.3216,0.3860,
15,"P",1.8882,44.8756,2.4685,13.5383,0.8046,2.6424,0.3204,0.3608,
16,"S",1.6591,36.6500,2.3863,11.4881,0.7899,2.4686,0.3208,0.3403,
17,"Cl",1.4524,30.9352,2.2926,9.9798,0.7874,2.3336,0.3217,0.3228,
18,"Ar",1.2736,26.6823,2.1894,8.8130,0.7927,2.2186,0.3225,0.3071,
19,"K",3.9507,137.0748,2.5452,22.4017,1.9795,4.5319,0.4817,0.4340,
20,"Ca",4.4696,99.5228,2.9708,22.6958,1.9696,4.1954,0.4818,0.4165,
21,"Sc",3.9659,88.9597,2.9169,20.6061,1.9254,3.8557,0.4802,0.3988,
22,"Ti",3.5653,81.9821,2.8181,19.0486,1.8930,3.5904,0.4825,0.3855,
23,"V",3.2449,76.3789,2.6978,17.7262,1.8597,3.3632,0.4864,0.3743,
24,"Cr",2.3066,78.4051,2.3339,15.7851,1.8226,3.1566,0.4901,0.3636,
25,"Mn",2.7467,67.7862,2.4556,15.6743,1.7923,2.9998,0.4984,0.3569,
26,"Fe",2.5440,64.4244,2.3434,14.8806,1.7588,2.8539,0.5062,0.3502,
27,"Co",2.3668,61.4306,2.2361,14.1798,1.7243,2.7247,0.5148,0.3442,
28,"Ni",2.2104,58.7267,2.1342,13.5530,1.6891,2.6094,0.5238,0.3388,
29,"Cu",1.5792,62.9403,1.8197,12.4527,1.6576,2.5042,0.5323,0.3331,
30,"Zn",1.9418,54.1621,1.9501,12.5177,1.6192,2.4164,0.5434,0.3295,
31,"Ga",2.3205,65.6019,2.4855,15.4577,1.6879,2.5806,0.5992,0.3510,
32,"Ge",2.4467,55.8930,2.7015,14.3930,1.6157,2.4461,0.6009,0.3415,
33,"As",2.3989,45.7179,2.7898,12.8166,1.5288,2.2799,0.5936,0.3277,
34,"Se",2.2980,38.8296,2.8541,11.5359,1.4555,2.1463,0.5895,0.3163,
35,"Br",2.1659,33.8987,2.9037,10.4996,1.3951,2.0413,0.5886,0.3070,
36,"Kr",2.0338,29.9992,2.9271,9.5977,1.3425,1.9520,0.5888,0.2986,
37,"Rb",4.7760,140.7821,3.8588,18.9910,2.2339,3.7010,0.8683,0.4194,
38,"Sr",5.8478,104.9721,4.0026,19.3666,2.3420,3.7368,0.8795,0.4142,
39,"Y",4.1290,27.5480,3.0120,5.0880,1.1790,0.5910,0.0000,0.0000,
40,"Zr",4.1050,28.4920,3.1440,5.2770,1.2290,0.6010,0.0000,0.0000,
41,"Nb",4.2370,27.4150,3.1050,5.0740,1.2340,0.5930,0.0000,0.0000,
42,"Mo",3.1199,72.4642,3.9061,14.6424,2.3615,3.2370,0.8504,0.3662,
43,"Tc",4.3180,28.2460,3.2700,5.1480,1.2870,0.5900,0.0000,0.0000,
44,"Ru",4.3580,27.8810,3.2980,5.1790,1.3230,0.5940,0.0000,0.0000,
45,"Rh",4.4310,27.9110,3.3430,5.1530,1.3450,0.5920,0.0000,0.0000,
46,"Pd",4.4360,28.6700,3.4540,5.2690,1.3830,0.5950,0.0000,0.0000,
47,"Ag",2.0355,61.4970,3.2716,11.8237,2.5105,2.8456,0.8372,0.3271,
48,"Cd",2.5737,55.6752,3.2586,11.8376,2.5468,2.7842,0.8379,0.3217,
49,"In",3.1528,66.6492,3.5565,14.4494,2.8180,2.9758,0.8842,0.3345,
50,"Sn",3.4495,59.1042,3.7349,14.1787,2.7779,2.8548,0.8786,0.3270,
51,"Sb",3.5644,50.4869,3.8437,13.3156,2.6866,2.6909,0.8638,0.3161,
52,"Te",4.7850,27.9990,3.6880,5.0830,1.5000,0.5810,0.0000,0.0000,
53,"I",3.4728,39.4411,4.0602,11.8161,2.5215,2.4148,0.8398,0.2976,
54,"Xe",3.3656,35.5094,4.1468,11.1170,2.4430,2.2940,0.8293,0.2892,
55,"Cs",6.0620,155.8336,5.9861,19.6951,3.3033,3.3354,1.0958,0.3793,
56,"Ba",7.8212,117.6575,6.0040,18.7782,3.2803,3.2634,1.1030,0.3760,
57,"La",4.9400,28.7160,3.9680,5.2450,1.6630,0.5940,0.0000,0.0000,
58,"Ce",5.0070,28.2830,3.9800,5.1830,1.6780,0.5890,0.0000,0.0000,
59,"Pr",5.0830,28.5880,4.0430,5.1430,1.6840,0.5810,0.0000,0.0000,
60,"Nd",5.1510,28.3040,4.0750,5.0730,1.6830,0.5710,0.0000,0.0000,
61,"Pm",5.2010,28.0790,4.0940,5.0810,1.7190,0.5760,0.0000,0.0000,
62,"Sm",5.2550,28.0160,4.1130,5.0370,1.7430,0.5770,0.0000,0.0000,
63,"Eu",6.2667,100.2983,4.8440,16.0662,3.2023,2.9803,1.2009,0.3674,
64,"Gd",5.2250,29.1580,4.3140,5.2590,1.8270,0.5860,0.0000,0.0000,
65,"Tb",5.2720,29.0460,4.3470,5.2260,1.8440,0.5850,0.0000,0.0000,
66,"Dy",5.3320,28.8880,4.3700,5.1980,1.8630,0.5810,0.0000,0.0000,
67,"Ho",5.3760,28.7730,4.4030,5.1740,1.8840,0.5820,0.0000,0.0000,
68,"Er",5.4360,28.6550,4.4370,5.1170,1.8910,0.5770,0.0000,0.0000,
69,"Tm",5.4410,29.1490,4.5100,5.2640,1.9560,0.5900,0.0000,0.0000,
70,"Yb",5.5290,28.9270,4.5330,5.1440,1.9450,0.5780,0.0000,0.0000,
71,"Lu",5.5530,28.9070,4.5800,5.1600,1.9690,0.5770,0.0000,0.0000,
72,"Hf",5.5880,29.0010,4.6190,5.1640,1.9970,0.5790,0.0000,0.0000,
73,"Ta",5.6590,28.8070,4.6300,5.1140,2.0140,0.5780,0.0000,0.0000,
74,"W",5.7090,28.7820,4.6770,5.0840,2.0190,0.5720,0.0000,0.0000,
75,"Re",5.6950,28.9680,4.7400,5.1560,2.0640,0.5750,0.0000,0.0000,
76,"Os",5.7500,28.9330,4.7730,5.1390,2.0790,0.5730,0.0000,0.0000,
77,"Ir",5.7540,29.1590,4.8510,5.1520,2.0960,0.5700,0.0000,0.0000,
78,"Pt",5.8030,29.0160,4.8700,5.1500,2.1270,0.5720,0.0000,0.0000,
79,"Au",2.3880,42.8656,4.2259,9.7430,2.6886,2.2641,1.2551,0.3067,
80,"Hg",2.6817,42.8217,4.2414,9.8557,2.7549,2.2951,1.2708,0.3067,
81,"Tl",5.9320,29.0860,4.9720,5.1260,2.1950,0.5720,0.0000,0.0000,
82,"Pb",3.5099,52.9141,4.5523,11.8840,3.1539,2.5713,1.3591,0.3205,
83,"Bi",3.8412,50.2608,4.6784,11.9988,3.1924,2.5598,1.3625,0.3177,
84,"Po",6.0700,28.0750,4.9970,4.9990,2.2320,0.5630,0.0000,0.0000,
85,"At",6.1330,28.0470,5.0310,4.9570,2.2390,0.5580,0.0000,0.0000,
86,"Rn",4.0779,28.4058,4.9778,11.0204,3.0955,2.3549,1.3259,0.2991,
87,"Fr",6.2010,28.2000,5.1210,4.9540,2.2750,0.5560,0.0000,0.0000,
88,"Ra",6.2150,28.3820,5.1700,5.0020,2.3160,0.5620,0.0000,0.0000,
89,"Ac",6.2780,28.3230,5.1950,4.9490,2.3210,0.5570,0.0000,0.0000,
90,"Th",6.2640,28.6510,5.2630,5.0300,2.3670,0.5630,0.0000,0.0000,
91,"Pa",6.3060,28.6880,5.3030,5.0260,2.3860,0.5610,0.0000,0.0000,
92,"U",6.7668,85.9510,6.7287,15.6415,4.0135,2.9364,1.5607,0.3348
};

